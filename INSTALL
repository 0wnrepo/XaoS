HOW TO COMPILE AND INSTALL XAOS
===============================

For end users, this documentation is unnecessary. Compilation is
interesting for you only if

  * you are a packager of a Linux distribution,
  * you want to try new features which are not yet included in the
    available binary packages for your distribution,
  * you want to try some changes/enhancements on XaoS source code.

You should be comfortable compiling software and executing commands from 
a Unix command line before attempting these instructions.
  
In other cases you are recommended to install a binary version using
your software installation tool (e.g. synaptic on Ubuntu/Debian
systems) or by downloading a package from http://xaos.sf.net.


For Unix/X11
============

To compile XaoS you need optimizing ANSI compatible C compiler and 
the Xlib library.

To compile XaoS with image saving code you also need zlib and pnglib
installed. They are available at:

  * ftp://ftp.uu.net/graphics/png/src/zlib-0.95.tar.gz
  * ftp://ftp.uu.net/graphics/png/src/libpng-0.81.tar.gz

But, in general, both are available in your Unix version automatically.

AA-lib is a library alowing high quality ascii-art output from XaoS
available at AA-project homepage http://aa-project.sf.net. You need at
least version 1.4. (At the time of writing this documentation, 1.4rc2 is
out and final version of AA-lib is not released yet. 1.4rc2 works
properly.)

To use internationalization (i18n) you also need GNU gettext.

XaoS now have a configure script so the following should work correctly:

  CFLAGS=(your best size optimizing switches)
  CFLAGS1=(your best speed optimizing switches)
  export CFLAGS

  # Note that these two steps are not required on PC/Linux
  # and for all gcc compilers XaoS uses quite good switches.
  # But this is REQUIRED for other compilers, because XaoS
  # is coded to be a good target for optimizer and NEEDS to
  # be optimized to work in reasonable speed.

  ./configure [options --- usually not required]
  make
  make install

For better results please edit src/include/config/config.autoconf to
reflect your system. 

To enable experimental SMP support please use:

  --with-pthread=yes


For Win32
=========

(Edited by Andreas Madritsch, 2002-10-03, 2003-03-04, 2003-03-18; April
and May 2008.)

Features/requirements
---------------------

XaoS has fully featured support for Win32 and DirectX API. The Win32
driver should work on Windows XP, Vista, and 7 in all bit 
depths supported by Windows. It was originally tested only on 
Windows 95 in 4, 8, 16, 24 and 32 bpp modes.
XaoS works well in all tested modes except the 16 color mode where it
uses Windows conversion routines and because they are slow and ugly,
XaoS is slow and ugly.

DirectX support is optional, so you don't need DirectX DLL libraries
installed on your system. The driver supports 8, 16, 24 and 32 bit
depths in fullscreen mode and 16, 24, 32 bit depths in windowed mode.
256 colors are not supported in windowed mode because of palette
mapping problems, so use win32 driver instead. In fullscreen mode press
'=' to change default resolution.

Build Requirements
------------------

To compile a fully-featured XaoS binary on Windows, you need the following
packages.

The packages are broken down by the functionality that requires them. If 
you are not trying to compile an official binary and only want to work on 
a certain part of the code, you can skip the dependencies that are not
relevant to the code you want to work on.

The recommended version of each package is listed. These versions have
been tested as of this writing and are used to build the official Windows
binary.  You can try to use newer versions if you like, but if you run into
problems, please try the version listed.

Always required:
* MinGW		5.1.4
* MSYS 		1.0.10

Required to regenerate configure script:
* msysDTK	1.0.1

Required to build with user formula support:
* nasm 		2.06

Required to build with DirectX support:
* DirectX SDK 	March 2009

Required to build with built-in help support:
* HTML Help SDK	1.3
* tidy 		060405

Required to build with image saving support:
* zlib 		1.2.3
* libpng 	1.2.37

Required to build with i18n support:
* libiconv 	1.9.2
* gettext	0.14.4

Required to build with smp support:
* Pthreads-w32	2.8.0

Required to build the installer:
* NSIS		2.45


Download Locations
------------------

The following are the download locations for the binaries required to build
XaoS on Windows.  All direct links are current as of this writing.  If a 
direct link is broken, please refer to the homepages instead to find the
current location of the package.

MinGW, MSYS, msysDTK 
````````````````````
Homepage: http://mingw.org/

* http://downloads.sourceforge.net/sourceforge/mingw/MSYS-1.0.10.exe
* http://downloads.sourceforge.net/sourceforge/mingw/MinGW-5.1.4.exe
* http://downloads.sourceforge.net/sourceforge/mingw/msysDTK-1.0.1.exe

nasm 
````
Homepage: http://www.nasm.us/

* http://www.nasm.us/pub/nasm/releasebuilds/2.06/win32/nasm-2.06-installer.exe

DirectX SDK
```````````
Homepage: http://msdn.microsoft.com/en-us/directx/aa937788.aspx

* http://www.microsoft.com/downloads/details.aspx?FamilyID=24a541d6-0486-4453-8641-1eee9e21b282&displaylang=en

HTML Help SDK
`````````````
Homepage: http://msdn.microsoft.com/en-us/library/ms669985%28VS.85%29.aspx

* http://go.microsoft.com/fwlink/?linkid=14188

tidy
````
Homepage: http://tidy.sourceforge.net/

* http://tidy.sourceforge.net/trt/tidy_win32.zip

zlib, libpng, libiconv, gettext
```````````````````````````````
Homepage: http://gnuwin32.sourceforge.net/

* http://gnuwin32.sourceforge.net/downlinks/gettext.php
* http://gnuwin32.sourceforge.net/downlinks/libiconv.php
* http://gnuwin32.sourceforge.net/downlinks/zlib.php
* http://downloads.sourceforge.net/gnuwin32/libpng-1.2.37-setup.exe

Pthreads-w32
````````````
Homepage: http://sourceware.org/pthreads-win32/

* ftp://sourceware.org/pub/pthreads-win32/pthreads-w32-2-8-0-release.exe

NSIS
````
Homepage: http://nsis.sourceforge.net/Main_Page

* http://prdownloads.sourceforge.net/nsis/nsis-2.45-setup.exe?download


Preparation
-----------

Run the installer for each of the dependencies above using the default 
options.  If desired, you can specify a different install location, but you 
will have to adjust the instructions accordingly.

Pthreads-w32 will extract to the current directory by default. The recommended
installation location is C:\pthreads-w32.

Tidy does not have an installer; it is just a zipped EXE file, so put it
somewhere in your path.  C:\MinGW\bin would be a good location if that is
where you installed MinGW.

Run MSYS by clicking the icon in your start menu or on your desktop.  This
will bring you to a bash prompt very similar to Linux or Unix.  Extract the
XaoS source distribution here or check out the latest sources from Subversion.

Copy the file msys_profile from the tools directory in the XaoS source
distribution to "$HOME/.profile".  

Edit the "$HOME/.profile" file and make sure all the *_HOME variables at the 
top point to the correct location where you installed each of the 
dependencies.  These variables are necessary so that MinGW can find the 
libraries and header files that you installed to various locations on your 
computer.  You should not have to modify the second half of the file.

Copy the file msys_manifest from the tools directory in the XaoS source
distibution to the /bin directory with the following commands:

  cp tools/msys_manifest /bin/install.exe.manifest
  cp tools/msys_manifest /bin/install-info.exe.manifest
  cp tools/msys_manifest /bin/patch.exe.manifest

These files are necessary to prevent "Permission Denied" errors caused by UAC
under Windows Vista and Windows 7 when running these programs.

Rename /bin/rxvt.exe to /bin/rxvt1.exe with the following command:

  mv /bin/rxvt.exe /bin/rxvt1.exe

This will prevent the MSYS prompt from opening in rxvt and use a standard 
windows console window instead. This is necessary because some programs
such as svn will not work correctly when run from rxvt.

Exit and restart MSYS so that these changes will take effect.


Building XaoS
-------------

To build XaoS, type the following commands from the XaoS source root:

  ./configure
  make

XaoS will automatically detect what dependencies you have installed and
configure itself to support whatever features are available.  If you find
that some feature is missing, please verify that you have installed the
corresponding dependency and that the installation location is specified
correctly in your "$HOME/.profile" file.

To compile XaoS with thread support you pass the switch --with-pthread=yes 
to the configure script.

To build the windows help file go to the help directory and run the following
command:

  make chm

To install XaoS to a staging directory, type the following commands:

  export DESTDIR=<installdir>
  make install-win

where <installdir> should be the absolute path of the folder in which XaoS 
should be installed.

To build the XaoS installer, install XaoS to
XaoS/src/ui/ui-drv/win32/installer/XaoS. Use NSIS to compile the script XaoS
Installer.nsi in the directory XaoS/src/ui/ui-drv/win32/installer.
